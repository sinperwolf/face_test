/*!
 * bootstrap-imgupload v2.0.0 2016/03/25
 * https://github.com/egonolieux/bootstrap-imgupload
 * Copyright 2016 Egon Olieux
 * Released under the MIT license
 */
!function(e){function i(e){var i=[];return i.push("<div class='alert alert-danger alert-dismissible'>"),i.push("<button type='button' class='close' data-dismiss='alert'>"),i.push("<span>&times;</span>"),i.push("</button>"+e),i.push("</div>"),i.join("")}function n(e){return"<img src='"+e+"' alt='Image preview' class='img-thumbnail' style='max-width: "+o.previewWidth+"px; max-height: "+o.previewHeight+"px'>"}function t(i){if(!i.hasClass("active")){var n=i.closest(".imgupload"),t=n.find(".url-tab");i.addClass("active"),n.find(".file-tab").show(),n.find(".panel-heading .btn:eq(1)").removeClass("active"),t.hide(),t.find(".alert").remove(),t.find("input").val(""),e.each(t.find(".btn"),function(i,n){"Remove"==e(n).text()?e(n).remove():e(n).text("Submit")}),t.find("img").remove()}}function a(t){var a=t.find("input"),s=t.closest(".file-tab");s.find(".alert").remove(),s.find("img").remove();var l=a[0].files&&a[0].files[0];if(l){var r=a[0].files[0];if(r.size/1024>o.maxFileSizeKb)return a.val(""),void s.append(i("File size is too large (max "+o.maxFileSizeKb+"kB)."));var d=r.name.substr(r.name.lastIndexOf(".")+1).toLowerCase();if(e.inArray(d,o.allowedFormats)>-1){var f=new FileReader;f.onload=function(e){s.append(n(e.target.result))},f.onerror=function(e){a.val(""),s.append(i("Error loading image."))},f.readAsDataURL(r),t.find("span").text("Change"),s.find(".btn:eq(1)").css("display","inline-block")}else a.val(""),s.append(i("Image format is not allowed."))}}function s(e){var i=e.closest(".file-tab");i.find(".alert").remove(),i.find(".btn span").text("Browse"),i.find("input").val(""),i.find("img").remove(),e.hide()}function l(e){if(!e.hasClass("active")){var i=e.closest(".imgupload"),n=i.find(".file-tab");e.addClass("active"),i.find(".url-tab").show(),i.find(".panel-heading .btn:eq(0)").removeClass("active"),n.hide(),n.find(".alert").remove(),n.find("input").val(""),n.find(".btn span").text("Browse"),n.find(".btn:eq(1)").hide(),n.find("img").remove()}}function r(t){var a=t.closest(".url-tab"),s=a.find("input:text"),l=a.find(".btn");s.prop("disabled",!0),l.prop("disabled",!0),a.find(".alert").remove(),a.find("img").remove(),d(a.find("input:text").val(),function(t,r,d){r?(a.find("input:hidden").val(t),a.append(n(t)),1==l.length&&(a.find(".input-group-btn").append("<button type='button' class='btn btn-default'>Remove</button>"),a.find(".btn:eq(1)").click(function(){e(this).blur(),a.find(".alert").remove(),a.find("input").val(""),a.find("img").remove(),e(this).remove()}))):(2==l.length&&l[1].remove(),a.append(i(d))),s.prop("disabled",!1),l.prop("disabled",!1)})}function d(i,n){var t=new Image;t.onerror=function(){n(i,!1,"Image could not be found.")},t.onload=function(){var t=i.substr(i.lastIndexOf(".")+1).toLowerCase();e.inArray(t,o.allowedFormats)>-1?n(i,!0,""):n(i,!1,"Image format is not allowed.")},t.src=i}var o={allowedFormats:["jpg","jpeg","png","gif"],previewWidth:250,previewHeight:250,maxFileSizeKb:2048};e.fn.imgupload=function(i){if(this.filter("div").hasClass("imgupload")){o=e.extend(o,i),this.find(".panel-heading .btn:eq(0)").click(function(){e(this).blur(),t(e(this))});var n=this.find(".file-tab");n.find(".btn:eq(0)").change(function(){e(this).blur(),a(e(this))}),n.find(".btn:eq(1)").click(function(){e(this).blur(),s(e(this))}),this.find(".panel-heading .btn:eq(1)").click(function(){e(this).blur(),l(e(this))});var d=this.find(".url-tab");d.find(".btn:eq(0)").click(function(){e(this).blur(),r(e(this))})}return this}}(jQuery);